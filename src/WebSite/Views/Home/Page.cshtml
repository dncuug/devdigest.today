@using X.PagedList;
@using X.PagedList.Mvc.Core;
@model IPagedList<WebSite.ViewModels.PublicationViewModel>

@{
    var categoryId = ViewBag.CategoryId as int?;
    var category = categoryId.HasValue ? Model.Select(o => o.Category.Name).FirstOrDefault()?.ToLower() : string.Empty;
}

@if (categoryId.HasValue)
{
    <h1><span class="protocol">stream://&nbsp;</span>@category</h1>
    <br />
}

@for (var i = 0; i < Model.Count(); i++)
{
    @await Html.PartialAsync("_Publication", Model[i])

    if (i == 2)
    {
        @await Html.PartialAsync("_InFeedAd")
    }
}

@if (categoryId != null)
{
    @Html.PagedListPager(Model, page => $"/page/{page}?categoryId={categoryId}")
}
else
{
    @Html.PagedListPager(Model, page => $"/page/{page}")
}
